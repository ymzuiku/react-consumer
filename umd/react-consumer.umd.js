!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("querystring-number"),require("react")):"function"==typeof define&&define.amd?define(["querystring-number","react"],e):(t=t||self).ReactConsumer=e(t.queryString,t.React)}(this,function(d,y){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function l(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var v=function(){return(v=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},m="block",g="block",w=1,b=3,S=2,C="absolute",k="relative",U="auto",E="none";return{bindRouteManager:function(t){var e=function(a){function r(t,e){var n=t+e;if(c.has(n))return c.get(n);var i=t&&t.split("/"),o=e&&e.split("/");if(!o||!i)return c.set(n,!1),!1;var r=!0;return i.forEach(function(t,e){"*"!==t&&t!==o[e]&&(r=!1)}),c.set(n,r),r}function n(t){for(var e=a.getState().paths,n=!1,i=-1,o=e.length-1;0<=o;o--){if(r(t,e[o])){i=o,n=!0;break}}return{match:r(t,e[e.length-1]),stackMatch:n,lastPage:r(t,e[e.length-2]),index:i}}function s(){if(0<window.location.hash.length){var t=window.location.hash.split("?"),e=t[0],n=t[1],i=void 0===n?"":n;return[e.replace(h,""),i]}return[window.location.pathname,window.location.search||""]}function u(e,n){i.forEach(function(t){t(e,n,a.getState())})}function l(i,o,r){i!==a.getState().paths[a.getState().paths.length-1]&&(a.update(function(t){t.paths.push(i);var e=v({},t.history[i],o);if(t.history[i]=e,"undefined"!=typeof window&&!r&&!f){var n=d.stringify(e);window.history.pushState(null,""+h+i,""===n?""+h+i:""+h+i+"?"+n)}}),u(i,o))}function p(t,n){var i=a.getState(),o="number"==typeof t?t:i.paths.length-1,e=i.paths[o-1],r=i.history[e];a.update(function(t){for(var e=0;e<t.paths.length-o;e++)n||window.history.back(),t.history[i.paths[o]]={},t.paths.pop()}),u(e,r)}var c=new Map,h="",f=!1,i=new Set;if("undefined"!=typeof window){window.addEventListener("popstate",function(){var t=a.getState().paths;if(s()[0]!==t[t.length-1]){var n=!1;if(t.forEach(function(t,e){t===s()[0]&&(n=!0)}),n)p(void 0,!0);else{var e=s(),i=e[0],o=e[1];l(i,""!==o?d.parse(o):void 0,!0)}}else u(s()[0],void 0)})}return{checkUrlMatch:n,checkUrlsStaskTop:function(t,e){return n(t).index===e.map(function(t){return n(t).index}).slice().sort(function(t,e){return e-t})[0]},init:function(t,e,n){if(void 0===n&&(n="#"),f=e||!1,h=n,a.update(function(t){t.paths=[],t.history=v({},t.history)}),"undefined"!=typeof window){var i=s(),o=i[0],r=i[1];"/"===o||o===t?l(t,d.parse(r)):(l(t),setTimeout(function(){l(o,d.parse(r))}))}},listen:function(t){return i.add(t),function(){i.delete(t)}},pop:p,push:l,replace:function(i,o){var t=a.getState(),r=i||t.paths[t.paths.length-1];a.update(function(t){var e=v({},t.history[i],o);if(t.history[i]=e,t.paths[t.paths.length-1]=r,"undefined"!=typeof window){var n=d.stringify(e);window.history.replaceState(null,""+h+r,""===n?""+h+r:""+h+r+"?"+n)}}),u(r,o)}}}(t);return{Route:function(f){var t,o;return l(e,o=y.Component),e.prototype.componentDidMount=function(){this.unListen=f.listen(this.onHistoryUpdate)},e.prototype.componentWillUnmount=function(){this.unListen&&this.unListen(),this.realChild=null,this.animeTimer=null},e.prototype.render=function(){var t=this.props.path,e=this.state,n=e.style;return e.isRenderChild?y.createElement("div",{about:t,style:v({width:"100%",height:"100%",overflow:"hidden",left:0,top:0},n)},this.realChild):null},(t=e).defaultProps={sync:"sync",keep:!0,animeTime:0},t;function e(t){var h=o.call(this,t)||this;h.animeTimer=null,h.realChild=null,h.state={isRenderChild:null,realChild:null,style:{display:g,position:C,zIndex:w}},h.unListen=null,h.onHistoryUpdate=function(){var t=h.props,e=t.path,n=t.delay,i=t.component,o=t.keep,r=t.leaveTime,a=h.state.isRenderChild,s=f.checkUrlMatch(e),u=s.match,l=s.stackMatch,p=s.lastPage;if(u)h.realChild||(void 0===n?(h.realChild=y.createElement(i,null),h.onHistoryUpdate()):i().then(function(t){h.realChild=y.createElement(t,null),h.onHistoryUpdate()})),h.setState({isRenderChild:!0,style:{pointerEvents:U,display:m,position:k,zIndex:b}});else{var c=o&&l;void 0!==a&&!0!==a||(p&&r&&0<r?h.setState({style:{pointerEvents:U,display:m,position:C,zIndex:m}},function(){setTimeout(function(){h.setState({isRenderChild:c,style:{pointerEvents:E,display:g,position:C,zIndex:w}})},r)}):h.setState({isRenderChild:c,style:{pointerEvents:E,display:g,position:C,zIndex:p?S:w}}))}};var e=h.props,n=e.delay,i=e.component;return void 0!==n&&0!==n&&setTimeout(function(){h.state.realChild||i()},n),h}}(e),routeMap:e}},createStateManager:function(t,e){function n(t){return o.add(t),function(){o.delete(t)}}var i,o=new Set,r=t,s={listen:n,getState:function(){return r},subscribes:o,update:function(t){r=e(s.getState(),t),o.forEach(function(t){t(r)})}},a=(l(u,i=y.Component),u.prototype.componentWillUnmount=function(){this.unListen&&(this.unListen(),this.unListen=null),this.props.beforeUnmount&&this.props.beforeUnmount(this.lastData)},u.prototype.render=function(){var t;return(t=this.props).children.apply(t,this.lastData)},u);function u(t){var a=i.call(this,t)||this;return a.lastData=[],a.state={num:0},a.unListen=null,a.handleListen=function(t){for(var e=a.props,n=e.beforeUpdate,i=(0,e.subscribe)(s.getState()),o=!1,r=0;r<a.lastData.length;r++)if(a.lastData[r]!==i[r]){o=!0;break}a.lastData=i.slice(),o&&(void 0!==n&&n(i),a.setState(function(t){var e=t.num;return{num:900<e?1:e+1}}))},a.shouldComponentUpdate=function(t,e){if(e.num!==a.state.num)return!0;if(t.memo){for(var n=a.props.memo,i=!1,o=0;o<n.length;o++)if(t.memo[o]!==n[o]){i=!0;break}return i}return!1},a.props.subscribe&&(a.lastData=a.props.subscribe(s.getState()).slice(),a.unListen=n(a.handleListen)),a}return{store:s,Consumer:a}}}});
//# sourceMappingURL=react-consumer.umd.js.map
